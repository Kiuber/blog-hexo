---
title: Excel常用功能
tags:
  - 统计
categories:
  - Excel
abbrlink: 70f3446a
date: 2016-10-25 21:42:21
---

{% cq %}对于复杂数据常用的Excel小功能。{% endcq %}


<!--more-->

-->环境：Office2016

Excel常用来做一些统计，咱们就根据需求进行函数介绍。

# 需求一

老师统计了一些平时不做作业，上课不认真听讲的同学名单，想看下他们的上学期的成绩。

最简单的就是按照名字一个个复制，名字多的时候就有点尴尬了。

|      | 姓名             |
| ---- | -------------- |
| 不认真  | 张三、李四、王五、赵六、孙七 |

成绩表

| 姓名   | 成绩   |
| ---- | ---- |
| 张三   | 61   |
| 王二麻子 | 88   |
| 李四   | 60.2 |
| 赵六   | 60.9 |
| 王五   | 60.2 |
| 孙七   | 60.1 |

最终结果

| 姓名   | 成绩   |
| ---- | ---- |
| 张三   | 61   |
| 李四   | 60.1 |
| 王五   | 60.2 |
| 赵六   | 60.2 |
| 孙七   | 60.9 |

## 实现

先将一个单元格内容分成多个单元格，然后将多个横排的单元格转换成竖排的，最后根据名字去成绩表中查找对应的成绩。

1. 选中名字单元格-->数据-->数据工具-->分列
2. 选中分列后的多个单元格右键-->粘贴-->转置
3. 用VLOOKUP（纵向查找函数）进行查找，参数分别为lookup_value、table_array、col_index_num、[range_lookup]

| 姓名   | 成绩                           |
| ---- | ---------------------------- |
| 张三   | =VLOOKUP(A2,D$1:E$7,2,FALSE) |
| 李四   | =VLOOKUP(A3,D$1:E$7,2,FALSE) |
| 王五   | =VLOOKUP(A4,D$1:E$7,2,FALSE) |
| 赵六   | =VLOOKUP(A5,D$1:E$7,2,FALSE) |
| 孙七   | =VLOOKUP(A6,D$1:E$7,2,FALSE) |

一定不要忘记在table_array区域填"$"对数据区域进行绝对引用。

# 需求二

根据旷课记录表查看以下表中的人是否有旷课记录。

| 姓名   | 是否旷课 |
| ---- | ---- |
| 张三   | 是    |
| 李四   | 是    |
| 孙七   | 否    |

旷课表

| 信息与艺术设计系旷课记录表 |                      |
| ------------- | -------------------- |
| 姓名            | 课程名                  |
| 王二麻子          | ASP.NET项目开发实战        |
| 王二麻子          | ASP.NET项目开发实战        |
| 李四            | ASP.NET项目开发实战        |
| 王二麻子          | Android移动应用基础教程      |
| 张三            | Android移动应用基础教程      |
| 王二麻子          | 毛泽东思想和中国特色社会主义理论体系概论 |

最终表

| 姓名   | 是否旷课 |
| ---- | ---- |
| 张三   | 是    |
| 李四   | 是    |
| 孙七   | 否    |

## 实现

其实这种也是用VLOOKUP来实现。

| 姓名   | 是否旷课                           |
| ---- | ------------------------------ |
| 张三   | =VLOOKUP(A2,C$13:D$19,2,FALSE) |
| 李四   | =VLOOKUP(A3,C$13:D$19,2,FALSE) |

如果有返回值不为“#N/A”，即代表有旷课记录，用Ctrl+R替换下数据就可，但是这样还不是最简单的，有没有一步到位的，有旷课记录的话直接返回“是“，没有的话返回”否“。

| 姓名   | 是否旷课                                     |
| ---- | ---------------------------------------- |
| 张三   | =IF(ISERROR(VLOOKUP(A2,C$13:D$19,2,FALSE)),"否","是") |
| 李四   | =IF(ISERROR(VLOOKUP(A2,C$13:D$19,2,FALSE)),"否","是") |
| 孙七   | =IF(ISERROR(VLOOKUP(A2,C$13:D$19,2,FALSE)),"否","是") |

